<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no"/>
		<title>01_音悦台</title>
		<link rel="stylesheet" type="text/css" href="css/index.css"/>
	</head>
	<body>
		<!--包裹区域-->
		<section class="wrap">
			<!--头部-->
			<header id="header">
				<!--头部上半部分-->
				<div id="headerT">
					<!--头部区域的logo-->
					<h1 id="logo">
						<a href="javascript:;">
							<img src="img/logo.png"/>
						</a>
					</h1>
					
					<!--菜单按钮-->
					<a href="javascript:;" id="menuBtn" class="menuBtnClos"></a>
					
					<!--按钮排-->
					<div id="btns">
						<a href="javascript:;" id="searchBtn">搜索</a>
						<a href="javascript:;">登陆</a>
						<a href="javascript:;">注册</a>
					</div>
				</div>
				
				<!--搜索区域-->
				<form id="search">
					<input type="text" name="wangshuai" placeholder="请输入搜索内容" />
					<input type="submit" value="搜索"/>
				</form>
				
				<!--遮罩区域-->
				<ul id="list">
                    <li><a href="javascript:;" >首页</a></li>
                    <li><a href="javascript:;">MV</a></li>
                    <li><a href="javascript:;">悦单</a></li>
                    <li><a href="javascript:;">V榜</a></li>
                    <li><a href="javascript:;">音悦stage</a></li>
                    <li><a href="javascript:;">商城</a></li>
                    <li><a href="javascript:;">节目</a></li>
                    <li><a href="javascript:;">饭团</a></li>
                    <li><a href="javascript:;" >资讯</a></li>
                    <li><a href="javascript:;" >我的家</a></li>
                    <li><a href="javascript:;" >APP下载</a></li>
                    <li><a href="javascript:;" >热门应用</a></li>
                </ul>
			</header>
			<section id="content">
				<!--可拖拽的导航-->
				<nav id="nav_wrap">
					<ul id="nav_list">
						<li><a href="javascript:;" class="nav_active">首页</a></li>
	                    <li><a href="javascript:;">MV</a></li>
	                    <li><a href="javascript:;">悦单</a></li>
	                    <li><a href="javascript:;">V榜</a></li>
	                    <li><a href="javascript:;">音悦stage</a></li>
	                    <li><a href="javascript:;">商城</a></li>
	                    <li><a href="javascript:;">节目</a></li>
	                    <li><a href="javascript:;">饭团</a></li>
	                    <li><a href="javascript:;" >资讯</a></li>
	                    <li><a href="javascript:;" >我的家</a></li>
	                    <li><a href="javascript:;" >APP下载</a></li>
	                    <li><a href="javascript:;" >热门应用</a></li>
	                    <li><a href="javascript:;" >张晓飞</a></li>
	                    <li><a href="javascript:;" >佟刚</a></li>
	                    <li><a href="javascript:;" >黑羊</a></li>
	                    <li><a href="javascript:;" >王帅1</a></li>
	                    <li><a href="javascript:;" >王帅2</a></li>
	                    <li><a href="javascript:;" >王帅3</a></li>
					</ul>
				</nav>
				<!--无缝滑屏-->
				<div id="pic_wrap">
					<ul id="pic_list">
						<li>
							<img src="img/1.jpg"/>
						</li>
						<li>
							<img src="img/2.jpg"/>
						</li>
						<li>
							<img src="img/3.jpg"/>
						</li>
						<li>
							<img src="img/4.jpg"/>
						</li>
						<li>
							<img src="img/5.jpg"/>
						</li>
					</ul>
					<div id="pic_nav">
						<span class="pic_active"></span>
						<span></span>
						<span></span>
						<span></span>
						<span></span>
					</div>
				</div>
				<!--tab切换-->
				<section class="tab">
					<header class="tab_header">
						<h2>MV主播</h2>
						<a href="javascript:;">更多&gt;</a>
					</header>
					<nav class="tab_nav">
						<a href="javascript:;">全部</a>
						<a href="javascript:;">内地</a>
						<a href="javascript:;">港台</a>
						<a href="javascript:;">欧美</a>
						<a href="javascript:;">韩国</a>
						<a href="javascript:;">日本</a>
						<span></span>
					</nav>
					<section class="tab_wrap">
						<ul class="tab_loading"></ul>
						<ul class="tab_list">
							<li>
								<a href="javascript:;">
									<img src="img/a.jpg"/>
									<span>Scribble, And Beyond Scribble, And Beyond</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/b.jpg"/>
									<span>Double Down</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>5936</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>13</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/c.jpg"/>
									<span>王叔</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/d.jpg"/>
									<span>INCEPTION</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/e.jpg"/>
									<span>You Only Live Once</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/f.jpg"/>
									<span>Xmas Kiss</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
						</ul>
						<ul class="tab_loading"></ul>
					</section>
				</section>
				<section class="tab">
					<header class="tab_header">
						<h2>MV主播</h2>
						<a href="javascript:;">更多&gt;</a>
					</header>
					<nav class="tab_nav">
						<a href="javascript:;">全部</a>
						<a href="javascript:;">内地</a>
						<a href="javascript:;">港台</a>
						<a href="javascript:;">欧美</a>
						<a href="javascript:;">韩国</a>
						<a href="javascript:;">日本</a>
						<span></span>
					</nav>
					<section class="tab_wrap">
						<ul class="tab_loading"></ul>
						<ul class="tab_list">
							<li>
								<a href="javascript:;">
									<img src="img/a.jpg"/>
									<span>Scribble, And Beyond Scribble, And Beyond</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/b.jpg"/>
									<span>Double Down</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>5936</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>13</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/c.jpg"/>
									<span>王叔</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/d.jpg"/>
									<span>INCEPTION</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/e.jpg"/>
									<span>You Only Live Once</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/f.jpg"/>
									<span>Xmas Kiss</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
						</ul>
						<ul class="tab_loading"></ul>
					</section>
				</section>
				<section class="tab">
					<header class="tab_header">
						<h2>MV主播</h2>
						<a href="javascript:;">更多&gt;</a>
					</header>
					<nav class="tab_nav">
						<a href="javascript:;">全部</a>
						<a href="javascript:;">内地</a>
						<a href="javascript:;">港台</a>
						<a href="javascript:;">欧美</a>
						<a href="javascript:;">韩国</a>
						<a href="javascript:;">日本</a>
						<span></span>
					</nav>
					<section class="tab_wrap">
						<ul class="tab_loading"></ul>
						<ul class="tab_list">
							<li>
								<a href="javascript:;">
									<img src="img/a.jpg"/>
									<span>Scribble, And Beyond Scribble, And Beyond</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/b.jpg"/>
									<span>Double Down</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>5936</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>13</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/c.jpg"/>
									<span>王叔</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/d.jpg"/>
									<span>INCEPTION</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/e.jpg"/>
									<span>You Only Live Once</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/f.jpg"/>
									<span>Xmas Kiss</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
						</ul>
						<ul class="tab_loading"></ul>
					</section>
				</section>
				<section class="tab">
					<header class="tab_header">
						<h2>MV主播</h2>
						<a href="javascript:;">更多&gt;</a>
					</header>
					<nav class="tab_nav">
						<a href="javascript:;">全部</a>
						<a href="javascript:;">内地</a>
						<a href="javascript:;">港台</a>
						<a href="javascript:;">欧美</a>
						<a href="javascript:;">韩国</a>
						<a href="javascript:;">日本</a>
						<span></span>
					</nav>
					<section class="tab_wrap">
						<ul class="tab_loading"></ul>
						<ul class="tab_list">
							<li>
								<a href="javascript:;">
									<img src="img/a.jpg"/>
									<span>Scribble, And Beyond Scribble, And Beyond</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/b.jpg"/>
									<span>Double Down</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>5936</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>13</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/c.jpg"/>
									<span>王叔</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/d.jpg"/>
									<span>INCEPTION</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/e.jpg"/>
									<span>You Only Live Once</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/f.jpg"/>
									<span>Xmas Kiss</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
						</ul>
						<ul class="tab_loading"></ul>
					</section>
				</section>
				<section class="tab">
					<header class="tab_header">
						<h2>MV主播</h2>
						<a href="javascript:;">更多&gt;</a>
					</header>
					<nav class="tab_nav">
						<a href="javascript:;">全部</a>
						<a href="javascript:;">内地</a>
						<a href="javascript:;">港台</a>
						<a href="javascript:;">欧美</a>
						<a href="javascript:;">韩国</a>
						<a href="javascript:;">日本</a>
						<span></span>
					</nav>
					<section class="tab_wrap">
						<ul class="tab_loading"></ul>
						<ul class="tab_list">
							<li>
								<a href="javascript:;">
									<img src="img/a.jpg"/>
									<span>Scribble, And Beyond Scribble, And Beyond</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/b.jpg"/>
									<span>Double Down</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>5936</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>13</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/c.jpg"/>
									<span>王叔</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/d.jpg"/>
									<span>INCEPTION</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/e.jpg"/>
									<span>You Only Live Once</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/f.jpg"/>
									<span>Xmas Kiss</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
						</ul>
						<ul class="tab_loading"></ul>
					</section>
				</section>
				<section class="tab">
					<header class="tab_header">
						<h2>MV主播</h2>
						<a href="javascript:;">更多&gt;</a>
					</header>
					<nav class="tab_nav">
						<a href="javascript:;">全部</a>
						<a href="javascript:;">内地</a>
						<a href="javascript:;">港台</a>
						<a href="javascript:;">欧美</a>
						<a href="javascript:;">韩国</a>
						<a href="javascript:;">日本</a>
						<span></span>
					</nav>
					<section class="tab_wrap">
						<ul class="tab_loading"></ul>
						<ul class="tab_list">
							<li>
								<a href="javascript:;">
									<img src="img/a.jpg"/>
									<span>Scribble, And Beyond Scribble, And Beyond</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/b.jpg"/>
									<span>Double Down</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>5936</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>13</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/c.jpg"/>
									<span>王叔</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/d.jpg"/>
									<span>INCEPTION</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/e.jpg"/>
									<span>You Only Live Once</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/f.jpg"/>
									<span>Xmas Kiss</span>
								</a>
								<div class="ice">
									<div class="ice_left">
										<span class="ice_pic"></span>
										<span>1.5W</span>
									</div>
									<div class="ice_right">
										<span class="ice_pic"></span>
										<span>16</span>
									</div>
								</div>
							</li>
						</ul>
						<ul class="tab_loading"></ul>
					</section>
				</section>
				
			</section>
			<div id="scroobar">

			</div>
		</section>
	</body>
	<script src="js/transform.js"></script>
	<script src="js/drag.js"></script>
	<script type="text/javascript">
		window.onload=function(){
			//清除事件的默认行为
			document.addEventListener("touchstart",function(ev){
				ev.preventDefault();
			});
			
			//rem适配方案
			(function(){
				var width = document.documentElement.clientWidth/16;
				var styleNode = document.createElement("style");
				styleNode.innerHTML="html{font-size:"+width+"px!important}"
				document.head.appendChild(styleNode);
			})()

			//可同步的选项卡
			tab();
			function tab(){
				var wraps = document.querySelectorAll(".tab_wrap");
				var navs = document.querySelectorAll(".tab_nav");
				
				//实现高可复用
				var translateX = navs[0].offsetWidth;
				for(var i=0;i<wraps.length;i++){
					move(wraps[i]);
				}
				
				function move(wrap){
					//矫正位置
					css(wrap,"translateX",-translateX);
					
					//实现防抖动滑屏
					var startX =0;
					var startY =0;
					var elementX =0;
					var elementY =0;
					//判断用户首次上来滑动的方向
					//判断滑动的方向
					var isX = true;
					var isFirst = true;
					//为了在发送ajax时，实现整个滑动区域不响应用户操作
					var isloading = false;
					var loading = wrap.querySelectorAll(".tab_loading");
					wrap.addEventListener("touchstart",function(ev){
						//ajax开关
						if(isloading){
							return;
						}
						wrap.style.transition="none";
						var touch = ev.changedTouches[0];
						startX = touch.clientX;
						startY = touch.clientY;
						elementX = css(wrap,"translateX");
						elementY = css(wrap,"translateY");
						
						isX=true;
						isFirst=true;
					})
					
					wrap.addEventListener("touchmove",function(ev){
						//ajax开关
						if(isloading){
							return;
						}
						//开关
						if(!isX){
							return;
						}
						var touch = ev.changedTouches[0];
						var nowX = touch.clientX;
						var nowY = touch.clientY;
						var disX = nowX -startX;
						var disY = nowY -startY;
						
						//解决抖动问题
						if(isFirst){
							isFirst=false;
							if(Math.abs(disY)>Math.abs(disX)){
								isX=false;
							}
						}
						css(wrap,"translateX",elementX + disX);
						
						
						if(Math.abs(disX) >= translateX/2){
							end(disX);
						}
					})
					
					wrap.addEventListener("touchend",function(ev){
						//ajax开关
						if(isloading){
							return;
						}
						wrap.style.transition="1s";
						var touch = ev.changedTouches[0];
						var nowX = touch.clientX;
						var disX = nowX -startX;
						if(Math.abs(disX) < translateX/2){
							css(wrap,"translateX",-translateX);
						}
					})
					
					//过半滑屏
					function end(disX){
						isloading=true;
						wrap.style.transition="0.5s";
						var target = disX>0?0:-2*translateX;
						css(wrap,"translateX",target);
						wrap.addEventListener("transitionend",transitionend);
						wrap.addEventListener("webkitTransitionEnd",transitionend);
					}
					
					
					//过渡结束，模拟ajax请求，将一些必要的控制重置回来
					function transitionend(){
						
						for(var i=0;i<loading.length;i++){
							loading[i].style.opacity="1";
						}
						wrap.removeEventListener("transitionend",transitionend);
						wrap.removeEventListener("webkitTransitionEnd",transitionend);
						
						//ajax
						setTimeout(function(){
							//dom操作显示其他的内容，但整个dom结构不会变
							
							
							
							
							wrap.style.transition="none";
							for(var i=0;i<loading.length;i++){
								loading[i].style.opacity="0";
							}
							css(wrap,"translateX",-translateX);
							isloading=false;
						},1000);
					}
				}
			}
			//无缝滑屏
			carouselFigure();
			function carouselFigure(){
//				var cssNode = document.querySelector("#css");
				var cssNode = document.createElement("style");
				var wrap = document.querySelector("#pic_wrap");
				var list = document.querySelector("#pic_list");
				list.innerHTML +=list.innerHTML;
				var liNodes = document.querySelectorAll("#pic_list li");
				var navs = document.querySelectorAll("#pic_nav span");
				
				var cssText = "#pic_list{width: "+(liNodes.length)+"00%;}";
					cssText += "#pic_list li{width:"+1/(liNodes.length)*100+"%;}";
					cssText += "#pic_wrap{height:"+liNodes[0].offsetHeight+"px;}";
				cssNode.innerHTML+=cssText;
				document.head.appendChild(cssNode);
				
				var startX =0;
				var startY =0;
				var elementX =0;
				var elementY =0;
				var now =0;
				var clear=0;
				
				//判断用户首次上来滑动的方向
				//判断滑动的方向
				var isX = true;
				var isFirst = true;
				wrap.addEventListener("touchstart",function(ev){
					clearInterval(clear);
					
					list.style.transition="none";
					
					if(now==0){
						now = navs.length;
					}else if(now==liNodes.length-1){
						now = navs.length-1;
					}
					css(list,"translateX",-now*wrap.offsetWidth);				
					
					var touch = ev.changedTouches[0];
					startX = touch.clientX;
					startY = touch.clientY;
					elementX = css(list,"translateX");
					elementY = css(list,"translateY");
					
					isX=true;
					isFirst=true;
				})
				wrap.addEventListener("touchmove",function(ev){
					//开关
					if(!isX){
						return;
					}
					var touch = ev.changedTouches[0];
					var nowX = touch.clientX;
					var nowY = touch.clientY;
					var disX = nowX -startX;
					var disY = nowY -startY;
					
//					解决抖动问题
					if(isFirst){
						isFirst=false;
						if(Math.abs(disY)>Math.abs(disX)){
							isX=false;
						}
					}
					
					css(list,"translateX",elementX + disX);
					
				})
				
				wrap.addEventListener("touchend",function(){
					now =Math.round(-css(list,"translateX")/wrap.offsetWidth);
					if(now<0){
						now=0;
					}else if(now>liNodes.length-1){
						now=liNodes.length-1
					}
					autoMove();
//					auto();
				})
				
//				auto();
				function auto(){
					clear=setInterval(function(){
						
						if(now>=liNodes.length-1){
							list.style.transition="none";
							now = navs.length-1;
							css(list,"translateX",-now*wrap.offsetWidth);
						}
						
						setTimeout(function(){
							now++;
							autoMove()
						},20)
						
					},1000)
				}
				
				function autoMove(){
					list.style.transition="0.5s";
					css(list,"translateX",-now*wrap.offsetWidth);
					
					for(var i=0;i<navs.length;i++){
						navs[i].className="";
					}
					navs[now%navs.length].className = "pic_active";
				}
			}

			//竖向快速滑屏即点即停
			dragFast()
			function dragFast() {
				var head = document.querySelector('#header');
				head.addEventListener('touchstart',function (ev) {
					ev.stopPropagation();
				});
				head.addEventListener('touchmove',function (ev) {
					ev.stopPropagation();
				});
				head.addEventListener('touchend',function (ev) {
					ev.stopPropagation();
				});

				var search = document.querySelector('#search');

				var wrap = document.querySelector(".wrap");
				var content = document.querySelector('#content');
				var scroobar = document.querySelector('#scroobar');
				var scale = wrap.clientHeight/content.offsetHeight;
				scroobar.style.height = wrap.clientHeight*scale+'px';
				var callBack = {};
				callBack.start = function () {
					console.log('start');
					scroobar.style.opacity = '1';
				}
				callBack.move = function () {
					console.log('move');
					var top = -css(content,'translateY')*scale;
					scroobar.style.opacity = '1';
					css(scroobar,'translateY',top);
					if(top>5){
						search.style.display = 'none';
					}else {
						search.style.display = 'block';
					}


				};
				callBack.end = function () {
					console.log('end');
					scroobar.style.opacity = '0';
				};
				fastFiguer(wrap,1,callBack);
				//搜索按钮行为
				var searchBtn = document.querySelector("#searchBtn");
				searchBtn.addEventListener("touchstart",function(){
					var top = -css(content,"translateY")*scale;
					//注意套路 先判断search.style.display=="block"
					if(search.style.display=="block"){
						if(top>5){
							search.style.display="none";
						}
					}else{
						search.style.display="block";
					}
				})
			}
			
			//导航的点击变色
			changeColor ();
			function changeColor(){
				var list = document.querySelector("#nav_list");
				var lis =document.querySelectorAll("#nav_list a");
				list.addEventListener("touchmove",function(){
					if(!this.move){
						this.move=true;
					}
				})
				list.addEventListener("touchend",function(ev){
					var touch = ev.changedTouches[0];
					if(!this.move){
						for(var i=0;i<lis.length;i++){
							lis[i].className="";
						}
						touch.target.className="nav_active";
					}
					this.move=false;
				})
			}
			
			//可拖拽的导航
			darg();
			function darg(){
				var wrap = document.querySelector("#nav_wrap");
				var list = document.querySelector("#nav_list");
				var minX = wrap.clientWidth - list.offsetWidth;
				
				var startX = 0;
				var elementX = 0;
				//橡皮筋系数
				var ratio = 1;
				
				
//				上一次的位置
				var lastPoint =0;
//				上一次的时间
				var lastTime = 0;
//				时间差   不能为0 一旦为0 第一次点击的时候，会出bug
				var timeV = 1;
//				位置差
				var pointV =0;
//				速度
				
				wrap.addEventListener("touchstart",function(ev){
//					解决速度的残留
					pointV =0;
					timeV = 1;
					list.style.transition="none";
					
					var touch = ev.changedTouches[0];
					startX = touch.clientX;
					elementX = css(list,"translateX");
					
					lastPoint = startX;
					lastTime = new Date().getTime();
					
				})
				
				wrap.addEventListener("touchmove",function(ev){
					var touch = ev.changedTouches[0];
					var nowX = touch.clientX;
					var dis = nowX - startX;
					var translateX=elementX+dis;
					//只有超出的时候，才存在橡皮筋效果
//					if(translateX>0){
//						//随着ul移动距离越来越大，整个ul移动距离的增幅越来越小
//						ratio = 0.6-translateX/(document.documentElement.clientWidth*3);
//						translateX=translateX*ratio;
//					}else if(translateX<minX){
//						//右边的留白（正值）
//						var over = minX - translateX;
//						ratio = 0.6-over/(document.documentElement.clientWidth*3);
//						translateX=minX-(over*ratio);
//					}
					if(translateX>0){
						//随着ul移动距离越来越大，整个ul移动距离的增幅越来越小
						ratio = document.documentElement.clientWidth/((document.documentElement.clientWidth+translateX)*1.8);
						translateX=translateX*ratio;
					}else if(translateX<minX){
						//右边的留白（正值）
						var over = minX - translateX;
						ratio = document.documentElement.clientWidth/((document.documentElement.clientWidth+over)*1.8);
						translateX=minX-(over*ratio);
					}
					
					var nowTime = new Date().getTime();
					var nowPoint = nowX;
					pointV = nowPoint - lastPoint;
					timeV = nowTime - lastTime;
					lastPoint = nowPoint;
					lastTime = nowTime;
					
//					console.log(timeV+" : "+pointV);
					css(list,"translateX",translateX);
				})
				
				wrap.addEventListener("touchend",function(){
					var speed = pointV/timeV;
					var addX = speed*200;
					var target= css(list,"translateX")+addX;
					var bessel ="";
					var time =0;
					time = Math.abs(speed)*0.3;
					time =time<0.3?0.3:time;
					
					if(target>0){
						target=0;
						bessel="cubic-bezier(.65,1.49,.63,1.54)";
					}else if(target<minX){
						target = minX;
						bessel="cubic-bezier(.65,1.49,.63,1.54)";
					}
					
					
					list.style.transition=time+"s "+bessel;
					css(list,"translateX",target);
				})
			}
			
			//输入框的获焦，失焦事件
			getFocus();
			function getFocus(){
				var textNode = document.querySelector("#search input[type='text']");
				textNode.addEventListener("touchstart",function(ev){
					this.focus();
					ev.stopPropagation();
				})
				document.addEventListener("touchstart",function(){
					textNode.blur();
				})
			}
			
			//系统菜单切换
			CMFCMenuBar();
			function CMFCMenuBar(){
				var menuBtn = document.querySelector("#menuBtn");
				var list =document.querySelector("#list");
				
				//不能使用touchend事件，跟document身上的逻辑会有冲突
				menuBtn.addEventListener("touchstart",function(ev){
					if(this.className == "menuBtnClos"){
						this.className = "menuBtnOpen";
						list.style.display="block";
					}else if(this.className == "menuBtnOpen"){
						this.className = "menuBtnClos";
						list.style.display="none";
					}
					
					ev.stopPropagation();
				})
				
				
				document.addEventListener("touchstart",function(){
					if(menuBtn.className == "menuBtnOpen"){
						menuBtn.className = "menuBtnClos";
						list.style.display="none";
					}
				})
				
				//避免事件点透
				list.addEventListener("touchstart",function(ev){
					ev.stopPropagation();
				})
			}
			
			
		}
	</script>
</html>
